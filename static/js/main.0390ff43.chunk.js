(this["webpackJsonpantti-corona-steamgraph"]=this["webpackJsonpantti-corona-steamgraph"]||[]).push([[0],{12:function(t){t.exports=JSON.parse('[{"year":2019,"total":5525292,"0-9":562211,"10-19":605496,"20-29":669629,"30-39":711550,"40-49":660848,"50-59":724665,"60-69":716579,"70-79":561908,"80-89":258262,"90-":54144,"80-":312406,"0-19":1167707,"20-39":1381179,"40-59":1385513,"60-79":1278487}]')},32:function(t,e,a){},34:function(t,e,a){},35:function(t,e,a){},36:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a(1),r=a.n(i),o=a(18),s=a.n(o),c=(a(32),a(9)),u=a.n(c),l=a(19),d=a(4),h=a(10),f=(a(34),a(47)),m=(a(35),["0-19","20-39","40-59","60-79","80-"]),g=function(t){return["00-10"].indexOf(t)>-1||["10-20"].indexOf(t)>-1?m[0]:["20-30"].indexOf(t)>-1||["30-40"].indexOf(t)>-1?m[1]:["40-50"].indexOf(t)>-1||["50-60"].indexOf(t)>-1?m[2]:["60-70"].indexOf(t)>-1||["70-80"].indexOf(t)>-1?m[3]:["80-"].indexOf(t)>-1?m[4]:"Kaikki ik\xe4ryhm\xe4t"===t?t:void 0},k=function(t){var e=t.stackedData,a=t.xScale,i=t.yScale,r=t.parseDate,o=t.date,s=t.categories,c=t.annotationText,u=t.orientation,l=function(t){var e=t.stackedData,a=(t.parsedData,t.parseDate),n=t.date,i=t.categories;console.log(e);var r=i.map((function(t){var i=e.find((function(e){return e.key===t})).find((function(t){return t.data.date.getDate()===a(n).getDate()&&t.data.date.getMonth()===a(n).getMonth()&&t.data.date.getYear()===a(n).getYear()}));try{return{x1:i[0],x2:i[1]}}catch(r){console.log("cannot find date ".concat(n))}}));return{x1:r[0].x1,x2:r[r.length-1].x2}}({stackedData:e,parseDate:r,date:o,categories:s}),d=l.x1,h=l.x2;return o=r(o),Object(n.jsxs)("g",{children:[Object(n.jsx)("circle",{cx:a(d),cy:i(o),r:"2",fill:"white"}),Object(n.jsx)("circle",{cx:a(h),cy:i(o),r:"2",fill:"white "}),Object(n.jsx)("path",{style:{stroke:"white",strokeWidth:2,fill:"none"},d:"\n            M".concat(a(d)," ").concat("down"===u?i(o)+5:i(o)-5," \n            L").concat(a(d)," ").concat("down"===u?i(o)+20:i(o)-20," \n            L").concat(a(h)," ").concat("down"===u?i(o)+20:i(o)-20,"\n            L").concat(a(h)," ").concat("down"===u?i(o)+5:i(o)-5,"\n            ")}),Object(n.jsx)("text",{x:a(d),y:"down"===u?i(o)+20+13:i(o)-20-10,style:{fontSize:"13px",fill:"white",transform:"translateX(0px)"},children:c})]})},j=function(t){var e=t.data,a=t.colors;t.height;return Object(n.jsx)(n.Fragment,{children:e.map((function(t,e){return Object(n.jsxs)("g",{children:[Object(n.jsx)("rect",{x:"0",y:30*e,width:"20",height:"20",style:{fill:a(t)}}),Object(n.jsx)("text",{x:"24",y:30*e+10,textAnchor:"left",style:{alignmentBaseline:"middle",fill:a(t)},children:t.key})]},e)}))})},p=function(t){var e=t.highlight,a=(t.xScale,t.bigTicks),i=(t.smallTicks,t.margin,t.width);t.height;return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("g",{children:[!1,!1,a.map((function(t){var a=t.value,r=t.yOffset;return Object(n.jsxs)("g",{transform:"translate(9.5, ".concat(r,")"),children:[Object(n.jsx)("line",{x1:i,strokeWidth:"0.3",strokeDasharray:"2 2",x2:0,stroke:e?"goldenrod":"white"}),Object(n.jsx)("text",{x:"40",style:{fontSize:"13px",fill:e?"goldenrod":"white",transform:"translate(".concat(i-100,"px, -6px)")},children:a},a)]},a)}))]})})},x=function(t){var e=t.vizProps,a=t.slideData,r=e.margin,o=e.width,s=e.height,c=e.stackedData,u=e.xScale,l=e.bigTicks,h=e.smallTicks,f=e.areas,m=e.yScale,g=e.greyColors,x=e.parseDate,O=e.brightColors,v={xScale:u,yScale:m,stackedData:c,parseDate:x};return Object(n.jsx)("section",{children:Object(n.jsx)("svg",{id:"dataviz-container",style:{width:o+r.left+r.right,height:s+r.top+r.bottom},children:Object(n.jsxs)("g",{id:"container",style:{transform:"translate("+r.left+"px,"+r.top+"px)"},children:[c.map((function(t,e){return Object(n.jsx)("path",{d:f(t),"data-index":t.key,style:{fill:a.allgrey||a.highlightedLayers&&!(a.highlightedLayers.indexOf(t.key)>-1)?g(t):O(t),stroke:(a.highlightedLayers&&a.highlightedLayers.indexOf(t.key),"none")}},t.index)})),a.annotations.map((function(t,e){return Object(i.createElement)(k,Object(d.a)(Object(d.a)({},v),{},{date:t.date,key:e,categories:t.categories,annotationText:t.text,orientation:t.orientation}))})),Object(n.jsx)(p,{highlight:a.highlightYAxis,xScale:u,bigTicks:l,smallTicks:h,margin:r,width:o,height:s}),Object(n.jsx)(j,{data:c,colors:O,height:s})]})})})},O=function(t){var e=t.slides,a=t.currentStepIndex;return Object(n.jsx)("div",{id:"circle-container",children:e.map((function(t,e){return Object(n.jsx)("div",{id:"circle",className:a>=e?"seen":"not-seen"},e)}))})},v=a(3),b=a(41),y=a(6),D=a(20),w=a.n(D),S=a(50),I=a(42),T=a(49),A=a(43),B=a(12),L=a(21),C=a(44),N=Object(L.a)({dateTime:"%A, %-d. %Bta %Y klo %X",date:"%-d.%-m.%Y",time:"%H:%M:%S",periods:["a.m.","p.m."],days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],shortDays:["Su","Ma","Ti","Ke","To","Pe","La"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kes\xe4kuu","hein\xe4kuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],shortMonths:["Tammi","Helmi","Maalis","Huhti","Touko","Kes\xe4","Hein\xe4","Elo","Syys","Loka","Marras","Joulu"]}),M=Object(C.b)("%d.%m.%Y"),K=N.format("%B"),z=N.format("%-d.%-m.%Y"),E=Object(C.a)("vko %V"),Y=a(45),G=a(46),P=a(48);var V=function(){var t={},e=function(t,e){return t.filter((function(t){return e.indexOf(t.group)>-1}))},a=function(t){return 0===t.length?0:t.reduce((function(t,e){var a=parseInt(e.value,10);return isNaN(a)&&(a=0),t+a}),0)};return{mostInfectionsOnADateByGroups:function(e,a,n){var i=function(t,e,a){return t.reduce((function(t,n){var i=n.group;return t[n.date]?t[n.date]=Object(d.a)(Object(d.a)({},t[n.date]),{},Object(y.a)({},i,(parseInt(t[n.date][i],10)||0)+(parseInt(n.value,10)||0))):(!e||!a||M(n.date)>M(e)&&M(n.date)<M(a))&&(t[n.date]=Object(y.a)({},i,n.value||0)),t}),{})}(t,a,n),r=Object.keys(i),o=[];r.map((function(t){var a={},n=0;e.forEach((function(e){a[e]=isNaN(parseInt(i[t][e],10))?0:parseInt(i[t][e],10),n+=isNaN(parseInt(i[t][e],10))?0:parseInt(i[t][e],10)})),a.sum=n,a.date=t,o.push(a)}));console.log(o);var s=Object(G.a)(o,(function(t){return t.sum})),c=o.find((function(t){return t.sum===s}));return{maxValue:s,date:c}},calculateByDateAndCategory:function(n,i){var r=function(t,e){return t.filter((function(t){return t.date===e}))}(t,n),o=e(r,i);return a(o)},under40ShareInPopulation:function(){var t=parseInt(B[0]["0-19"],10)+parseInt(B[0]["20-39"],10);return console.log(t),t/parseInt(B[0].total,10)*100},under40:function(){var n=t.map((function(t){return t.group})),i=(Object(v.a)(new Set(n)),e(t,["40-50","50-60","60-70","70-80","80-"])),r=e(t,["00-10","10-20","20-30","30-40"]),o=e(t,["Kaikki ik\xe4ryhm\xe4t"]);if([].concat(Object(v.a)(i),Object(v.a)(r),Object(v.a)(o)).length===t.length){var s=a([].concat(Object(v.a)(i),Object(v.a)(r)));return a(r)/s*100}},storeData:function(e){t=e},getData:function(){return t}}}(),R=function(t){var e=t.data,a=t.startDate,n=t.endDate,i=t.outliers,r=t.tickDates,o=t.nth,s=t.alwaysInclude,c=function(){var t={top:20,right:10,bottom:0,left:10};return{margin:t,width:(window.innerWidth>500?500:window.innerWidth)-t.left-t.right,height:(window.innerWidth>500?500:window.innerWidth)-t.top-t.bottom}}(),u=c.margin,l=c.width,h=c.height,f=function(t){var e=t.data,a=t.startDate,n=t.endDate,i=t.parseDate,r=t.outliers;return e.filter((function(t){return-1===r.indexOf(t.date)&&i(t.date)>i(a)&&i(t.date)<i(n)}))}({parseDate:M,data:e,startDate:a,endDate:n,outliers:i});V.storeData(f);var k=[{annotations:[],text:["<b><x-large>KUINKA IK\xc4 N\xc4KYY TARTUNTATILASTOISSA?</x-large></b>","<small>Skrollaa alasp\xe4in \u2b07</small>"]},{annotations:[],text:["Kuviossa n\xe4kyy covid-19-viruksen raportoidut tartunnat viiteen ik\xe4ryhm\xe4\xe4n jaoteltuna.","Tartunnoilla tarkoitetaan rekister\xf6ityj\xe4 positiivisia testituloksia."]},{highlightedLayers:["20-39"],annotations:[],text:["Yksi alue (v\xe4ri) edustaa kuviossa yht\xe4 ik\xe4ryhm\xe4\xe4.","Parhaillaan korostettuna n\xe4kyy tartuntam\xe4\xe4r\xe4ss\xe4 mitattuna suurin ryhm\xe4 eli 20\u201339-vuotiaat."]},{annotations:[{date:"10.11.2020",categories:["0-19"],text:"".concat(V.calculateByDateAndCategory("10.11.2020",["00-10","10-20"])," kpl"),orientation:"up"},{date:"10.11.2020",categories:["20-39"],text:"".concat(V.calculateByDateAndCategory("10.11.2020",["20-30","30-40"])," kpl"),orientation:"down"},{date:"10.11.2020",categories:["40-59"],text:"".concat(V.calculateByDateAndCategory("10.11.2020",["40-50","50-60"])," kpl"),orientation:"up"},{date:"10.11.2020",categories:["60-79"],text:"".concat(V.calculateByDateAndCategory("10.11.2020",["60-70","70-80"])," kpl"),orientation:"down"},{date:"10.11.2020",categories:["80-"],text:"".concat(V.calculateByDateAndCategory("10.11.2020",["80-"])," kpl"),orientation:"up"}],text:['P\xe4ivitt\xe4isen heilunnan tasaamiseksi tartuntoja kuvaavat datapisteet on laskettu kuviossa <a href="https://fi.wikipedia.org/wiki/Liukuva_keskiarvo" target="_blank">liukuviksi keskiarvoiksi</a> seitsem\xe4n p\xe4iv\xe4n ajalta. ',"Teksteiss\xe4 tartuntojen kappalem\xe4\xe4rill\xe4 viitataan kuitenkin absoluuttisiin lukuihin."]},{annotations:[],text:["Kunkin alueen leveys suhteessa muihin kuvaa tartuntojen lukum\xe4\xe4r\xe4\xe4.","Mit\xe4 leve\xe4mpi alue, sit\xe4 enemm\xe4n tartuntoja."]},{highlightedLayers:["0-19","20-39"],annotations:[],text:["Alle 40-vuotiaiden osuus kaikista varmistetuista tartunnoista on noin ".concat(Math.round(V.under40())," % &#185;."),'<span style="font-size: 12px">&#185;Ryhm\xe4n noin 2,5 miljoonaa j\xe4sent\xe4 kattaa '.concat(Math.round(V.under40ShareInPopulation())," % Suomen v\xe4est\xf6st\xe4.</font>")]},function(){var t=V.mostInfectionsOnADateByGroups(["00-10","10-20","20-30","30-40"]),e=t.date.date;return{highlightedLayers:["0-19","20-39"],text:["Suurimmillaan tartuntojen rekister\xf6innit olivat ".concat(t.date.date)],annotations:[{date:e,categories:["0-19","20-39"],text:"".concat(t.maxValue," kpl"),orientation:"up"}]}}(),function(){var t=V.mostInfectionsOnADateByGroups(["40-50","50-60","60-70","70-80","80-"]),e=t.date.date;return console.log(e),{highlightedLayers:["40-59","60-79","80-"],text:["My\xf6s vanhemmilla ik\xe4ryhmill\xe4 n\xe4htiin samoihin aikoihin huomattavaa kasvua."],annotations:[{date:e,categories:["40-59","60-79","80-"],text:"".concat(t.maxValue," kpl"),orientation:"down"}]}}(),(V.mostInfectionsOnADateByGroups(["00-10","10-20","20-30","30-40"],"1.8.2020","28.10.2020").date.date,{highlightedLayers:["0-19","20-39"],text:["Keskim\xe4\xe4rin eri ik\xe4ryhmien muutokset mukailevat melko hyvin toisiaan.","Syksyll\xe4 alle 40-vuotiaiden ryhm\xe4ss\xe4 n\xe4htiin kuitenkin hieman muita korkeampia lukuja."],annotations:[]}),function(){var t=V.mostInfectionsOnADateByGroups(["00-10","10-20","20-30","30-40"],"1.8.2020","28.10.2020"),e=V.mostInfectionsOnADateByGroups(["20-30"],"1.8.2020","28.10.2020");console.log(e);var a=t.date.date;return{highlightedLayers:["0-19","20-39"],text:["Korkeakoulujen alettua rekister\xf6itiin korkeimmillaan ".concat(t.maxValue," tartuntaa alle 40-vuotialla (").concat(a,")"),"T\xe4st\xe4 luvusta \n      ".concat(e.maxValue," rekister\xf6itiin 20\u201330-vuotiaiden osaryhm\xe4ss\xe4.")],annotations:[{date:a,categories:["0-19","20-39"],text:"".concat(t.maxValue," kpl"),orientation:"up"}]}}(),function(){var t=V.mostInfectionsOnADateByGroups(["40-50","50-60","60-70","70-80","80-"],"10.10.2020","20.10.2020"),e=t.date.date;return{highlightedLayers:["0-19","20-39"],text:["Kaikilla yli 40-vuotialla rekister\xf6itiin samoihin aikoihin enimmill\xe4\xe4n ".concat(t.maxValue," tartuntaa.")],annotations:[{date:e,categories:["40-59","60-79","80-"],text:"".concat(t.maxValue," kpl"),orientation:"up"}]}}(),{highlightedLayers:["0-19"],annotations:[],text:["Alle 20-vuotiaiden tartuntam\xe4\xe4riss\xe4kin n\xe4kyi selke\xe4\xe4 kasvua syksyn aikana.","T\xe4t\xe4 taustaa vasten my\xf6s lasten ja nuorten harrastustoimintaan kohdistuneet rajoitustoimet n\xe4ytt\xe4v\xe4t perustellummilta."]}],j=[];k.forEach((function(t){var e=t.annotations.map((function(t){return t.date}));j=[].concat(Object(v.a)(j),Object(v.a)(e))})),s=[].concat(Object(v.a)(s),Object(v.a)(j));var p,x,O,D=function(t,e){return Object(S.a)().offset(I.a).keys(e)(t)}(function(t){var e=t.data,a=t.parseDate,n=t.categories,i=t.categorizeGroup,r=t.nth,o=t.alwaysInclude,s=t.formatDateBackToOriginal,c=e.reduce((function(t,e){var a=i(e.group);return t[e.date]?t[e.date]=Object(d.a)(Object(d.a)({},t[e.date]),{},Object(y.a)({},a,(parseInt(t[e.date][a],10)||0)+(parseInt(e.value,10)||0))):t[e.date]=Object(y.a)({},a,e.value||0),t}),{}),u=[];for(var l in c)u.push(Object(d.a)(Object(d.a)({},c[l]),{},{date:a(l)}));!function(){for(var t={},e=function(e){var a=n[e],i=u.map((function(t){return t[a]})),r=w()(i,7);t[a]=r},a=0;a<n.length;a++)e(a);u.map((function(e,a){if(a<6)return null;for(var i=0;i<n.length;i++){var r=n[i],o=t[r][a-6];o="NaN"===o?0:o,o=parseInt(o),e[r]=o}})),u=u.slice(6)}();var h=u.filter((function(t){return o.indexOf(s(t.date))>-1}));console.log(o),console.log(h),u=function(t,e){return t.filter((function(t,a){return a%e===e-1}))}(u,r);var f=[].concat(Object(v.a)(u),Object(v.a)(h));return f.sort((function(t,e){return t.date-e.date})),f}({data:f,parseDate:M,categories:m,categorizeGroup:g,nth:o,alwaysInclude:s,formatDateBackToOriginal:z}),m),B=D[0].map((function(t){return t.data.date})),L=function(t){var e=t.allDates,a=(t.data,t.width,t.height),n=(t.parseDate,t.formatDate,t.margin,Object(Y.a)(e)),i=Object(G.a)(e);return Object(P.a)().domain([n,i]).range([0,a])}({data:D,width:l,height:h,margin:u,allDates:B,parseDate:M,formatDate:K}),C=function(t){var e=t.allDates,a=t.formatDateWeek,n=t.tickDates,i=t.parseDate,r=t.formatDate,o=t.yScale,s=(t.firstScaledDate,t.lastScaledDate,n.map((function(t){return i(t)})));return s.unshift(e[0]),{bigTicks:s.map((function(t){return{value:r(t),yOffset:o(t)}})),smallTicks:e.map((function(t){return{value:a(t),yOffset:o(t)}}))}}({tickDates:r,formatDate:K,yScale:L,parseDate:M,allDates:B,formatDateWeek:E}),N=C.bigTicks,R=C.smallTicks,W=function(t,e){var a=Object(Y.a)(e,(function(t){return Object(Y.a)(t,(function(t){return t[0]}))})),n=Object(G.a)(e,(function(t){return Object(G.a)(t,(function(t){return t[1]}))}));return Object(P.a)().domain([a,n]).range([50,t-50])}(l,D),H=(p=W,x=L,Object(T.a)().y((function(t){return x(t.data.date)})).x0((function(t){return p(t[0])})).x1((function(t){return p(t[1])})).curve(A.a)),_=(O=m,Object(b.a)().domain(O).range(["#e76f51","#f4a261","#e9c46a","#2a9d8f","#264653"])),J=function(t){return Object(b.a)().domain(t).range(["#dcd4d1","#ede2de","#e0cfc5","#cfc0b7","#d1c2c2"])}(m);return{vizProps:{margin:u,width:l,height:h,stackedData:D,xScale:W,bigTicks:N,smallTicks:R,areas:H,yScale:L,parseDate:M,brightColors:_,greyColors:J},slides:k}},W=a(17),H=function(t){var e=t.slides,a=t.setCurrentStepIndex,r=Object(i.useRef)(null);return Object(i.useEffect)((function(){if(r.current){var t=r.current.getBoundingClientRect().top,e=r.current.firstChild.getBoundingClientRect().height,a=r.current.style.top||0;r.current.style.marginTop=a-t-e/2-window.innerHeight/2+"px"}}),[r]),Object(n.jsx)("section",{ref:r,style:{height:"100%"},children:Object(n.jsx)(W.a,{offset:1,onStepEnter:function(t){var e=t.data,n=t.direction;a("up"===n&&e>0?e-1:e)},children:e.map((function(t,e){return Object(n.jsx)(W.b,{data:e,children:Object(n.jsx)("div",{style:{margin:"100vh 0",zIndex:999,position:"relative",transform:"translate3d(0,0,0)"},children:t.text.map((function(t,e){return Object(n.jsx)("p",{className:"text-paragraph",dangerouslySetInnerHTML:{__html:t}},e)}))})},e)}))})})},_={startDate:"15.4.2020",endDate:"20.1.2021",avgRange:7,nth:7,outliers:["26.11.2020","27.11.2020"],alwaysInclude:["10.12.2020","10.11.2020","15.9.2020","2.8.2020"],tickDates:["1.6.2020","1.7.2020","1.8.2020","1.9.2020","1.10.2020","1.11.2020","1.12.2020","1.1.2021"]},J=function(){var t=Object(i.useState)(null),e=Object(h.a)(t,2),a=e[0],r=e[1],o=Object(i.useState)(0),s=Object(h.a)(o,2),c=s[0],m=s[1],g=Object(i.useState)(null),k=Object(h.a)(g,2),j=k[0],p=k[1],v=Object(i.useState)(null),b=Object(h.a)(v,2),y=b[0],D=b[1],w=Object(i.useState)(0),S=Object(h.a)(w,2),I=S[0],T=S[1],A=Object(i.useRef)(null);return Object(i.useEffect)((function(){if(a){var t=R(Object(d.a)(Object(d.a)({},_),{},{data:a})),e=t.vizProps,n=t.slides;p(e),D(n)}}),[a]),Object(i.useEffect)((function(){if(A.current&&0===I){var t=A.current.getBoundingClientRect().height;T(t)}})),Object(i.useEffect)((function(){Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.a)("https://plus.yle.fi/lambda_sheets/korona/2021-01-korona_ikaryhma/data.json");case 2:e=t.sent,r(e.data);case 4:case"end":return t.stop()}}),t)})))()}),[]),Object(n.jsx)("div",{className:"App",children:j&&y?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("section",{ref:A,id:"dataviz",style:{position:"sticky",top:window.innerHeight/2-I/2+"px",left:0},children:[Object(n.jsx)(x,{vizProps:j,slideData:y?y[c]:null}),Object(n.jsx)(O,{slides:y,currentStepIndex:c})]}),Object(n.jsx)(H,{setCurrentStepIndex:m,slides:y})]}):Object(n.jsx)("section",{children:"Ladataan..."})})};console.info("NB! This visualisation does not work well in emualted environments e.g. under developer tools"),s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(J,{})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.0390ff43.chunk.js.map